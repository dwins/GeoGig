/* Copyright (c) 2013 OpenPlans. All rights reserved.
 * This code is licensed under the BSD New License, available at the root
 * application directory.
 */
package org.geogit.test.integration.je;

import org.geogit.storage.ConfigDatabase;
import org.geogit.storage.ObjectSerializingFactory;
import org.geogit.storage.bdbje.JEObjectDatabase;
import org.geogit.storage.datastream.DataStreamSerializationFactory;

import java.io.File;

import org.junit.Rule;
import org.junit.Test;
import org.junit.rules.TemporaryFolder;
import com.sleepycat.je.Environment;
import com.sleepycat.je.EnvironmentConfig;

public class JEReopenTest {
    @Rule
    public TemporaryFolder tempFolder = new TemporaryFolder();

    @Test
    public void testReopenJEObjectDatabase() throws Exception {
        ObjectSerializingFactory serializers = new DataStreamSerializationFactory();
        File dbHome = tempFolder.newFolder("dbhome");
        EnvironmentConfig envConfig = new EnvironmentConfig();
        envConfig.setAllowCreate(true);
        Environment env = new Environment(dbHome, envConfig);
        ConfigDatabase configDB = null;
        JEObjectDatabase jedb = new JEObjectDatabase(serializers, env, configDB);
        jedb.open();
        jedb.close();
        jedb.open();
        jedb.close();
    }
}
